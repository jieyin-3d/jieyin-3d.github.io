---
import siteConfig from '../data/site-config';

type Props = { class?: string };

const { class: className } = Astro.props;
const subscribe = siteConfig.subscribe;
if (!subscribe?.enabled || !subscribe?.form?.action) {
    return;
}
---

<section
    class:list={[
        'mx-auto flex w-full max-w-3xl flex-col items-center gap-4 rounded-md border border-slate-200 bg-slate-50 px-6 py-8 text-center sm:px-12 sm:py-14',
        className
    ]}
>
    {subscribe.title && <h2 class="max-w-xl text-2xl font-bold text-slate-900 sm:text-3xl">{subscribe.title}</h2>}
    {subscribe.text && <p class="max-w-xl text-slate-700 sm:text-lg">{subscribe.text}</p>}
    <form
        action={subscribe.form.action}
        method="post"
        name="subscribe-form"
        class:list={['flex w-full max-w-xl flex-col gap-2.5 sm:flex-row', { 'mt-4': subscribe.title || subscribe.text }]}
        target="_blank"
    >
        <input
            type="email"
            name={subscribe.form.emailFieldName || 'email'}
            required
            autocomplete="email"
            placeholder="您的電子郵件"
            class="w-full px-5 py-2 bg-white border rounded-full h-11 border-slate-200 text-slate-700 placeholder:text-slate-500 focus:outline-hidden"
            aria-label="電子郵件地址"
        />
        {subscribe.form.hiddenFields?.map((field) => <input type="hidden" name={field.name} value={field.value} />)}
        {
            subscribe.form.honeypotFieldName && (
                <div style="position: absolute; left: -5000px;" aria-hidden="true">
                    <input type="text" name={subscribe.form.honeypotFieldName} tabindex="-1" autocomplete="off" />
                </div>
            )
        }
        <button
            type="submit"
            class="bg-primary hover:shadow-button inline-flex w-full cursor-pointer items-center justify-center gap-1.5 rounded-full px-10 py-2.5 font-semibold text-white transition duration-300 sm:w-auto whitespace-nowrap"
        >
            立即問
        </button>
    </form>
</section>
